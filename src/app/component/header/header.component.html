<header *ngIf="isLoggedIn()">
    <div class="flex align-items-center mx-3 pt-3 mb-4">
        <div class="basis-1/10">
            <div class="bg-color-dark-grey-darker px-3 py-2 rounded-lg pointer max-w-48 min-h-46" (click)="toggleMenu()">
                <div class="width-sm relative top-2">
                    <app-ui-icon [descriptor]="{ 'type': 'standard', 'content': 'menu' }" />
                </div>
            </div>
        </div>
        <div class="flex-grow mx-4 pointer" (click)="onSearchIconClicked()">
            <div class="relative">
                <div class="width-sm absolute left-8 top-11">
                    <app-search [color]="colorLight" />
                </div>
                <div class="width-sm absolute left-search-close top-11 transition-fade" [ngClass]="{ 'hidden-fade': !isSearchCloseVisible() }" (click)="closeSearch()" appStopEventPropagation>
                    x
                </div>
                <input #search type="text" class="menu-search bg-color-dark-grey-darker text-light text-base pl-10 py-1 rounded-lg min-h-46" [ngClass]="{ 'menu-search-focus': isSearchFocused()  }" (input)="onSearchChange($event)" />
            </div>
        </div>
        <div class="basis-1/10">
            <div class="relative" appClickOutside (clickOutside)="hideAccountMenuIfOpen()">
                <div class="transition-fade" [ngClass]="{ 'hidden-fade': !isLoggedIn() }">
                    <div class="account-menu bg-color-dark-grey-darker px-3 py-2 rounded-lg pointer max-w-48 min-h-46" (click)="toggleAccountMenu()" [ngClass]="{ 'account-menu-open': isAccountMenuOpen() }">
                        <div class="width-sm flex align-items-center justify-content-center">
                            <div class="text-lg">{{ getLoginInitial() }}</div>
                        </div>
                    </div>
                </div>
                <div class="bg-color-dark-grey-darker absolute z-200 min-w-160 right-0 p-2 transition-fade context-menu-shadow rounded-md mt-2" [ngClass]="{ 'hidden-fade': !isAccountMenuOpen() }">
                    <div class="px-2 py-1 mb-3">
                        <div class="text-base">{{ getLoggedInName() }}</div>
                        <div class="text-sm text-light-grey">{{ getLoggedInEmail() }}</div>
                    </div>
                    <div>
                        <a class="inline-block w-full pointer hover:bg-color-dark-grey transition-bg-color px-2 py-1 rounded-sm" (click)="triggerNavigateToSettings()">{{ 'menu.settings' | $t }}</a>
                    </div>
                    <div class="section-divider my-2"></div>
                    <div>
                        <a class="inline-block w-full pointer hover:bg-color-dark-grey transition-bg-color px-2 py-1 rounded-sm" (click)="triggerLogout()">{{ 'menu.logout' | $t }}</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="menu-drawer h-full bg-color-dark-grey px-2 py-3 z-10" [ngClass]="{ 'menu-drawer-open': isMenuOpen() }">
        <app-nav-menu (onNavigationSelected)="onNavigation()" />
    </div>
    <div class="menu-drawer-overlay transition-fade" [ngClass]="{ 'hidden-fade': !isMenuOpen() }" (click)="overlayClick()"></div>
    <div class="search-results z-2 bg-color-dark-grey w-full h-full p-3" [ngClass]="{ 'search-results-open': isSearchResultOpen() }">
        <div class="text-lg bold">{{ 'search.results' | $t }}</div>
        @let resultItems = searchResultItems$ | async;
        <div>
            <div class="mt-4">
                <app-chip-group [chipGroup$]="searchTypeFilterChips$" (onSelected)="onSearchTypeFilterChanged($event)" />
            </div>
            <div class="w-full pt-6">
                @for (resultItem of resultItems; track $index) {
                    <div class="px-3 py-2 mb-3 last:mb-0 rounded-lg pointer hover:bg-color-dark-grey-darker transition-colors border-1 border-solid border-mid-grey hover:border-light-grey-darker" (click)="resultItemClicked(resultItem)">
                        <div class="mb-3">
                            <span class="text-xs bg-color-dark-grey-lighter-2 px-2 py-1 rounded-md">{{ getSearchResultItemTypeText(resultItem.type) }}</span>
                        </div>
                        <div class="flex align-items-center">
                            <div class="basis-1/10 flex align-items-center mr-3" *ngIf="resultItem.icon || resultItem.type === 'game'">
                                <div class="width-2-25rem" *ngIf="resultItem.type !== 'game'; else gameSearchResultIcon">
                                    <app-ui-icon [descriptor]="getIconDescriptor(resultItem)" />
                                </div>
                                <ng-template #gameSearchResultIcon>
                                    <div class="flex">
                                        @let homeTeamIcon = getGameSearchResultHomeTeamIcon(resultItem);
                                        @let awayTeamIcon = getGameSearchResultAwayTeamIcon(resultItem);
                                        <div class="width-xs" *ngIf="homeTeamIcon">
                                            <app-ui-icon [descriptor]="{ 'type': 'club', 'content': homeTeamIcon }" />
                                        </div>
                                        <div class="width-xs" *ngIf="awayTeamIcon">
                                            <app-ui-icon [descriptor]="{ 'type': 'club', 'content': awayTeamIcon }" />
                                        </div>
                                    </div>
                                </ng-template>
                            </div>
                            <div class="flex-grow">
                                <div *ngIf="resultItem.type !== 'game'; else gameSearchResultContent">{{ resultItem.title }}</div>
                                <ng-template #gameSearchResultContent>
                                    <div class="flex align-items-center">
                                        <div class="mr-4">
                                            <div class="text-sm text-light-grey-darker">{{ getGameSearchResultKickoff(resultItem) }}</div>
                                            <div class="mt-1 text-base">
                                                {{ getGameParticipants(resultItem) }}
                                            </div>
                                        </div>
                                        <div>
                                            <div class="game-result-tendency px-2 py-1 rounded-md center bold" [ngClass]="getResultTendencyClass(resultItem)">{{ getGameScoreBeforePso(resultItem) }}</div>
                                            <div class="text-xs mt-2 center" *ngIf="hasExtendedPlay(resultItem)">{{ getExtendedPlayText(resultItem) }}</div>
                                        </div>
                                    </div>                                    
                                </ng-template>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</header>